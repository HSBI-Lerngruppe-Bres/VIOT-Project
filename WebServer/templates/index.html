<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Smart Mailbox Dashboard</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f4f4f4; }
    </style>
</head>
<body>
    <h1>Smart Mailbox Dashboard</h1>

    <h2>Gewichtsdaten</h2>
<table>
    <tr>
        <th>Sensor ID</th>
        <th>Value</th>
        <th>Timestamp</th>
    </tr>
</table>

<h2>Alarme</h2>
<table>
    <tr>
        <th>Sensor ID</th>
        <th>Value</th>
        <th>Timestamp</th>
    </tr>
</table>
<script>
    $(document).ready(fetchData);
    function fetchData() {
        $.ajax({
            url: '/data',
            method: 'GET',
            success: function(data) {
                var weightsTable = $('table').first();
                weightsTable.find("tr:gt(0)").remove(); // Clear existing rows except the header
                data.weights.forEach(function(entry) {
                    var row = '<tr>' +
                        '<td>' + entry.sensor_id + '</td>' +
                        '<td>' + entry.value + '</td>' +
                        '<td>' + entry.timestamp + '</td>' +
                        '</tr>';
                    weightsTable.append(row);
                });

                var alarmsTable = $('table').last();
                alarmsTable.find("tr:gt(0)").remove(); // Clear existing rows except the header
                data.alarms.forEach(function(alarm) {
                    var row = '<tr>' +
                        '<td>' + alarm.sensor_id + '</td>' +
                        '<td>' + alarm.value + '</td>' +
                        '<td>' + alarm.timestamp + '</td>' +
                        '</tr>';
                    alarmsTable.append(row);
                });
            },
            error: function(error) {
                console.log('Error fetching data:', error);
            }
        });
    }

    fetchData(); // Initial fetch
    setInterval(fetchData, 10000); // Fetch data every minute
</script>
</body>
</html>
